# Ephemeral

## 소개
[KeyValueStorage](doc_aux_storage_key_value_storage.md)와 비슷한 키-값 저장소인데,
프로세스가 죽으면 그 프로세스가 생성한 값들이 자동으로(약 1초 이내에) 사라집니다.

[Apache ZooKeeper™](https://zookeeper.apache.org/)의 ephemeral node에서 개념을 따왔습니다.

## 용도
세션 등 프로세스의 메모리에 있는 객체에 대한 정보를 다른 프로세스들에게 노출하는 데 유용합니다.

## 주의사항
`_engine_` 으로 시작하는 그룹 이름은 엔진에 의해 예약되어 있습니다. 로직 코드에서는 사용하지 마세요.

## 구현
프로세스가 살아있는지 죽었는지를 확인하는 데는 MariaDB의 네임드 락(`GET_LOCK` 명령어)을 사용하고 있습니다.
프로세스가 엔진을 초기화하는 과정에서 MariaDB에 연결을 하나 만들고, 이 연결은 끊지 않습니다.
연결이 끊기면 네임드 락이 자동으로 풀리기 때문에, 프로세스가 죽었음을 인지할 수 있습니다.

즉, 하드웨어에 고장이 생긴 경우에는 프로세스가 죽었음을 감지하는 데 오랜 시간이 걸릴 수도 있습니다.

키-값을 저장하는 데는 Redis HASH와 SET 자료구조를 사용합니다.
